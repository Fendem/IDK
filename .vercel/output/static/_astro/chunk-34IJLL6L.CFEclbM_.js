var p=e=>typeof atob<"u"&&typeof atob=="function"?atob(e):typeof global<"u"&&global.Buffer?new global.Buffer(e,"base64").toString():e,g=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],y="pk_live_",m="pk_test_";function d(e,r={}){if(e=e||"",!e||!h(e)){if(r.fatal&&!e)throw new Error("Publishable key is missing. Ensure that your publishable key is correctly configured. Double-check your environment configuration for your keys, or access them here: https://dashboard.clerk.com/last-active?path=api-keys");if(r.fatal&&!h(e))throw new Error("Publishable key not valid.");return null}const t=e.startsWith(y)?"production":"development";let a=p(e.split("_")[2]);return a=a.slice(0,-1),r.proxyUrl?a=r.proxyUrl:t!=="development"&&r.domain&&(a=`clerk.${r.domain}`),{instanceType:t,frontendApi:a}}function h(e=""){try{const r=e.startsWith(y)||e.startsWith(m),t=p(e.split("_")[2]||"").endsWith("$");return r&&t}catch{return!1}}function k(){const e=new Map;return{isDevOrStagingUrl:r=>{if(!r)return!1;const t=typeof r=="string"?r:r.hostname;let a=e.get(t);return a===void 0&&(a=g.some(s=>t.endsWith(s)),e.set(t,a)),a}}}var E=(e,r="5.52.2")=>{if(e)return e;const t=w(r);return t?t==="snapshot"?"5.52.2":t:P(r)},w=e=>e.trim().replace(/^v/,"").match(/-(.+?)(\.|$)/)?.[1],P=e=>e.trim().replace(/^v/,"").split(".")[0];function M(e){return e?S(e)||v(e):!0}function S(e){return/^http(s)?:\/\//.test(e||"")}function v(e){return e.startsWith("/")}function x(e){return e?v(e)?new URL(e,window.location.origin).toString():e:""}function U(e){if(!e)return"";let r;if(e.match(/^(clerk\.)+\w*$/))r=/(clerk\.)*(?=clerk\.)/;else{if(e.match(/\.clerk.accounts/))return e;r=/^(clerk\.)*/gi}return`clerk.${e.replace(r,"")}`}var _=()=>{try{return!1}catch{}return!1},J=()=>{try{return!1}catch{}return!1},W=()=>{try{return!0}catch{}return!1},V=e=>{_()&&console.error(`Clerk: ${e}`)},C={firstDelay:125,maxDelay:0,timeMultiple:2,shouldRetry:()=>!0},K=async e=>new Promise(r=>setTimeout(r,e)),O=e=>{let r=0;const t=()=>{const a=e.firstDelay,s=e.timeMultiple,n=a*Math.pow(s,r);return Math.min(e.maxDelay||n,n)};return async()=>{await K(t()),r++}},R=async(e,r={})=>{let t=0;const{shouldRetry:a,firstDelay:s,maxDelay:n,timeMultiple:c}={...C,...r},o=O({firstDelay:s,maxDelay:n,timeMultiple:c});for(;;)try{return await e()}catch(u){if(t++,!a(u,t))throw u;await o()}},D="loadScript cannot be called when document does not exist",A="loadScript cannot be called without a src";async function L(e="",r){const{async:t,defer:a,beforeLoad:s,crossOrigin:n,nonce:c}=r||{};return R(()=>new Promise((u,l)=>{e||l(new Error(A)),(!document||!document.body)&&l(D);const i=document.createElement("script");n&&i.setAttribute("crossorigin",n),i.async=t||!1,i.defer=a||!1,i.addEventListener("load",()=>{i.remove(),u(i)}),i.addEventListener("error",()=>{i.remove(),l()}),i.src=e,i.nonce=c,s?.(i),document.body.appendChild(i)}),{shouldRetry:(u,l)=>l<5})}var I=Object.freeze({InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingSecretKeyErrorMessage:"Missing secretKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingClerkProvider:"{{source}} can only be used within the <ClerkProvider /> component. Learn more: https://clerk.com/docs/components/clerk-provider"});function T({packageName:e,customMessages:r}){let t=e;const a={...I,...r};function s(n,c){if(!c)return`${t}: ${n}`;let o=n;const u=n.matchAll(/{{([a-zA-Z0-9-_]+)}}/g);for(const l of u){const i=(c[l[1]]||"").toString();o=o.replace(`{{${l[1]}}}`,i)}return`${t}: ${o}`}return{setPackageName({packageName:n}){return typeof n=="string"&&(t=n),this},setMessages({customMessages:n}){return Object.assign(a,n||{}),this},throwInvalidPublishableKeyError(n){throw new Error(s(a.InvalidPublishableKeyErrorMessage,n))},throwInvalidProxyUrl(n){throw new Error(s(a.InvalidProxyUrlErrorMessage,n))},throwMissingPublishableKeyError(){throw new Error(s(a.MissingPublishableKeyErrorMessage))},throwMissingSecretKeyError(){throw new Error(s(a.MissingSecretKeyErrorMessage))},throwMissingClerkProviderError(n){throw new Error(s(a.MissingClerkProvider,n))},throw(n){throw new Error(s(n))}}}var f="Clerk: Failed to load Clerk",{isDevOrStagingUrl:$}=k(),b=T({packageName:"@clerk/shared"});function j(e){b.setPackageName({packageName:e})}var H=async e=>{const r=document.querySelector("script[data-clerk-js-script]");if(r)return new Promise((t,a)=>{r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{a(f)})});if(!e?.publishableKey){b.throwMissingPublishableKeyError();return}return L(F(e),{async:!0,crossOrigin:"anonymous",nonce:e.nonce,beforeLoad:B(e)}).catch(()=>{throw new Error(f)})},F=e=>{const{clerkJSUrl:r,clerkJSVariant:t,clerkJSVersion:a,proxyUrl:s,domain:n,publishableKey:c}=e;if(r)return r;let o="";s&&M(s)?o=x(s).replace(/http(s)?:\/\//,""):n&&!$(d(c)?.frontendApi||"")?o=U(n):o=d(c)?.frontendApi||"";const u=t?`${t.replace(/\.+$/,"")}.`:"",l=E(a);return`https://${o}/npm/@clerk/clerk-js@${l}/dist/clerk.${u}browser.js`},N=e=>{const r={};return e.publishableKey&&(r["data-clerk-publishable-key"]=e.publishableKey),e.proxyUrl&&(r["data-clerk-proxy-url"]=e.proxyUrl),e.domain&&(r["data-clerk-domain"]=e.domain),e.nonce&&(r.nonce=e.nonce),r},B=e=>r=>{const t=N(e);for(const a in t)r.setAttribute(a,t[a])};export{W as a,T as b,V as c,h as d,J as i,H as l,j as s};
